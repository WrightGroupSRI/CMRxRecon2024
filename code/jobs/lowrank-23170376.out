/local/var/spool/slurmd/job23170376/slurm_script: line 14: 
cd to this file and run: sbatch train_lowrank.sh, not sure if this fully trains
and may need more gpu/time
: No such file or directory
Mon Jul 15 10:26:06 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.129.03             Driver Version: 535.129.03   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  Tesla P100-PCIE-12GB           Off | 00000000:04:00.0 Off |                    0 |
| N/A   38C    P0              26W / 250W |      0MiB / 12288MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
|   1  Tesla P100-PCIE-12GB           Off | 00000000:83:00.0 Off |                    0 |
| N/A   34C    P0              25W / 250W |      0MiB / 12288MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
created virtual environment CPython3.11.5.final.0-64 in 1234ms
  creator CPython3Posix(dest=/local/kadotab.23170376.0/env, clear=False, no_vcs_ignore=False, global=False)
  seeder FromAppData(download=False, pip=bundle, setuptools=bundle, wheel=bundle, via=copy, app_data_dir=/home/kadotab/.local/share/virtualenv)
    added seed packages: pip==24.0+computecanada, setuptools==70.0.0+computecanada, wheel==0.43.0
  activators BashActivator,CShellActivator,FishActivator,NushellActivator,PowerShellActivator,PythonActivator
Looking in links: /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic
Requirement already satisfied: pip in /local/kadotab.23170376.0/env/lib/python3.11/site-packages (24.0+computecanada)
Looking in links: /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/absl_py-2.1.0+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 1))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3/aiohttp-3.9.1+computecanada-cp311-cp311-linux_x86_64.whl (from -r /home/kadotab/requirements2.txt (line 2))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/aiosignal-1.3.1+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 3))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/appdirs-1.4.4+computecanada-py2.py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 4))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/attrs-23.2.0+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 5))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/cachetools-5.3.2+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 6))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/certifi-2023.7.22+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 7))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/charset_normalizer-3.2.0+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 8))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/click-8.1.7+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 9))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/contourpy-1.2.0+computecanada-cp311-cp311-linux_x86_64.whl (from -r /home/kadotab/requirements2.txt (line 10))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/cycler-0.12.1+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 11))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/docker_pycreds-0.4.0+computecanada-py2.py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 12))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/einops-0.7.0+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 13))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/filelock-3.13.1+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 14))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/fonttools-4.47.2+computecanada-cp311-cp311-linux_x86_64.whl (from -r /home/kadotab/requirements2.txt (line 15))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/frozenlist-1.4.1+computecanada-cp311-cp311-linux_x86_64.whl (from -r /home/kadotab/requirements2.txt (line 16))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/fsspec-2024.2.0+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 17))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/gitdb-4.0.11+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 18))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/GitPython-3.1.40+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 19))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/google_auth-2.25.2+computecanada-py2.py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 20))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/google_auth_oauthlib-1.2.0+computecanada-py2.py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 21))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/grpcio-1.57.0+computecanada-cp311-cp311-linux_x86_64.whl (from -r /home/kadotab/requirements2.txt (line 22))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3/h5py-3.10.0+computecanada-cp311-cp311-linux_x86_64.whl (from -r /home/kadotab/requirements2.txt (line 23))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/idna-3.4+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 24))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/Jinja2-3.1.3+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 25))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3/kiwisolver-1.4.5+computecanada-cp311-cp311-linux_x86_64.whl (from -r /home/kadotab/requirements2.txt (line 26))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/lightning_utilities-0.10.0+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 27))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/Markdown-3.5.2+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 28))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/MarkupSafe-2.1.3+computecanada-cp311-cp311-linux_x86_64.whl (from -r /home/kadotab/requirements2.txt (line 29))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3/matplotlib-3.7.2+computecanada-cp311-cp311-linux_x86_64.whl (from -r /home/kadotab/requirements2.txt (line 30))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/monai-1.3.0+computecanada-202310121228-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 31))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/mpmath-1.3.0+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 32))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/multidict-6.0.5+computecanada-cp311-cp311-linux_x86_64.whl (from -r /home/kadotab/requirements2.txt (line 33))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/networkx-3.2.1+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 34))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/nibabel-5.2.0+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 35))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/generic/numpy-1.25.2+computecanada-cp311-cp311-linux_x86_64.whl (from -r /home/kadotab/requirements2.txt (line 36))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/oauthlib-3.2.2+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 37))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/packaging-23.2+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 38))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3/pillow-10.2.0+computecanada-cp311-cp311-linux_x86_64.whl (from -r /home/kadotab/requirements2.txt (line 39))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3/Pillow_SIMD-9.0.0.post1+computecanada-cp311-cp311-linux_x86_64.whl (from -r /home/kadotab/requirements2.txt (line 40))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3/protobuf-4.23.4+computecanada-cp311-cp311-linux_x86_64.whl (from -r /home/kadotab/requirements2.txt (line 41))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/psutil-5.9.8-cp310-abi3-linux_x86_64.whl (from -r /home/kadotab/requirements2.txt (line 42))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/pyasn1-0.5.1+computecanada-py2.py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 43))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/pyasn1_modules-0.3.0+computecanada-py2.py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 44))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/pyparsing-3.0.9+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 45))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/python_dateutil-2.8.2+computecanada-py2.py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 46))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/pytorch_lightning-2.1.2+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 47))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3/PyYAML-6.0.1+computecanada-cp311-cp311-linux_x86_64.whl (from -r /home/kadotab/requirements2.txt (line 48))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/requests-2.31.0+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 49))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/requests_oauthlib-1.3.1+computecanada-py2.py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 50))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/rsa-4.9+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 51))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/generic/scipy-1.11.2+computecanada-cp311-cp311-linux_x86_64.whl (from -r /home/kadotab/requirements2.txt (line 52))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/sentry_sdk-1.38.0+computecanada-py2.py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 53))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/setproctitle-1.3.2+computecanada-cp311-cp311-linux_x86_64.whl (from -r /home/kadotab/requirements2.txt (line 54))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/six-1.16.0+computecanada-py2.py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 55))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/smmap-5.0.1+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 56))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/sympy-1.12+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 57))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/tensorboard-2.15.1+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 58))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/tensorboard_data_server-0.7.0+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 59))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3/torch-2.2.1+computecanada-cp311-cp311-linux_x86_64.whl (from -r /home/kadotab/requirements2.txt (line 60))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/torchmetrics-1.2.1+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 61))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/generic/torchvision-0.17.1+computecanada-cp311-cp311-linux_x86_64.whl (from -r /home/kadotab/requirements2.txt (line 62))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/tqdm-4.66.2+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 63))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/typing_extensions-4.10.0+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 64))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/urllib3-2.1.0+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 65))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/wandb-0.16.0+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 66))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/werkzeug-3.0.1+computecanada-py3-none-any.whl (from -r /home/kadotab/requirements2.txt (line 67))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3/yarl-1.9.3+computecanada-cp311-cp311-linux_x86_64.whl (from -r /home/kadotab/requirements2.txt (line 68))
Requirement already satisfied: setuptools in /local/kadotab.23170376.0/env/lib/python3.11/site-packages (from lightning_utilities==0.10.0+computecanada->-r /home/kadotab/requirements2.txt (line 27)) (70.0.0+computecanada)
Installing collected packages: mpmath, appdirs, urllib3, typing_extensions, tqdm, tensorboard_data_server, sympy, smmap, six, setproctitle, PyYAML, pyparsing, pyasn1, psutil, protobuf, Pillow_SIMD, pillow, packaging, oauthlib, numpy, networkx, multidict, MarkupSafe, Markdown, kiwisolver, idna, grpcio, fsspec, frozenlist, fonttools, filelock, einops, cycler, click, charset_normalizer, certifi, cachetools, attrs, absl_py, yarl, werkzeug, sentry_sdk, scipy, rsa, requests, python-dateutil, pyasn1_modules, nibabel, lightning_utilities, Jinja2, h5py, gitdb, docker-pycreds, contourpy, aiosignal, torch, requests_oauthlib, matplotlib, google_auth, GitPython, aiohttp, wandb, torchvision, torchmetrics, monai, google_auth_oauthlib, tensorboard, pytorch_lightning
Successfully installed GitPython-3.1.40+computecanada Jinja2-3.1.3+computecanada Markdown-3.5.2+computecanada MarkupSafe-2.1.3+computecanada Pillow_SIMD-9.0.0.post1+computecanada PyYAML-6.0.1+computecanada absl_py-2.1.0+computecanada aiohttp-3.9.1+computecanada aiosignal-1.3.1+computecanada appdirs-1.4.4+computecanada attrs-23.2.0+computecanada cachetools-5.3.2+computecanada certifi-2023.7.22+computecanada charset_normalizer-3.2.0+computecanada click-8.1.7+computecanada contourpy-1.2.0+computecanada cycler-0.12.1+computecanada docker-pycreds-0.4.0+computecanada einops-0.7.0+computecanada filelock-3.13.1+computecanada fonttools-4.47.2+computecanada frozenlist-1.4.1+computecanada fsspec-2024.2.0+computecanada gitdb-4.0.11+computecanada google_auth-2.25.2+computecanada google_auth_oauthlib-1.2.0+computecanada grpcio-1.57.0+computecanada h5py-3.10.0+computecanada idna-3.4+computecanada kiwisolver-1.4.5+computecanada lightning_utilities-0.10.0+computecanada matplotlib-3.7.2+computecanada monai-1.3.0+computecanada mpmath-1.3.0+computecanada multidict-6.0.5+computecanada networkx-3.2.1+computecanada nibabel-5.2.0+computecanada numpy-1.25.2+computecanada oauthlib-3.2.2+computecanada packaging-23.2+computecanada pillow-10.2.0+computecanada protobuf-4.23.4+computecanada psutil-5.9.8 pyasn1-0.5.1+computecanada pyasn1_modules-0.3.0+computecanada pyparsing-3.0.9+computecanada python-dateutil-2.8.2+computecanada pytorch_lightning-2.1.2+computecanada requests-2.31.0+computecanada requests_oauthlib-1.3.1+computecanada rsa-4.9+computecanada scipy-1.11.2+computecanada sentry_sdk-1.38.0+computecanada setproctitle-1.3.2+computecanada six-1.16.0+computecanada smmap-5.0.1+computecanada sympy-1.12+computecanada tensorboard-2.15.1+computecanada tensorboard_data_server-0.7.0+computecanada torch-2.2.1+computecanada torchmetrics-1.2.1+computecanada torchvision-0.17.1+computecanada tqdm-4.66.2+computecanada typing_extensions-4.10.0+computecanada urllib3-2.1.0+computecanada wandb-0.16.0+computecanada werkzeug-3.0.1+computecanada yarl-1.9.3+computecanada
W&B offline. Running your script from this directory will only write metadata locally. Use wandb disabled to completely turn off W&B.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/2
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/2
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 2 processes
----------------------------------------------------------------------------------------------------

wandb: WARNING `resume` will be ignored since W&B syncing is set to `offline`. Starting a new run with run id 3zvb7tcb.
wandb: Tracking run with wandb version 0.16.0
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]

  | Name  | Type        | Params
--------------------------------------
0 | model | LowRankModl | 16.0 M
--------------------------------------
16.0 M    Trainable params
4         Non-trainable params
16.0 M    Total params
64.179    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
SLURM auto-requeueing enabled. Setting signal handlers.
Counting Slices in aorta_sag
Found 1191 slices!
Counting Slices in aorta_tra
Found 1202 slices!
Counting Slices in T1map
Found 1038 slices!
Counting Slices in T2map
Found 1038 slices!
Counting Slices in tagging
Found 1570 slices!
Counting Slices in cine_lvot
Found 193 slices!
Counting Slices in cine_lax
Found 585 slices!
Counting Slices in cine_sax
Found 1809 slices!
Counting Slices in aorta_sag
Found 1191 slices!
Counting Slices in aorta_tra
Found 1202 slices!
Counting Slices in T1map
Found 1038 slices!
Counting Slices in T2map
Found 1038 slices!
Counting Slices in tagging
Found 1570 slices!
Counting Slices in cine_lvot
Found 193 slices!
Counting Slices in cine_lax
Found 585 slices!
Counting Slices in cine_sax
Found 1809 slices!
/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/logger_connector/result.py:433: It is recommended to use `self.log('val/loss', ..., sync_dist=True)` when logging on epoch level in distributed setting to accumulate the metric across devices.
Traceback (most recent call last):
  File "/home/kadotab/python/CMRxRecon2024/code/train.py", line 46, in <module>
    main(args)
  File "/home/kadotab/python/CMRxRecon2024/code/train.py", line 31, in main
    trainer.fit(model=model, datamodule=data_module)
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
    call._call_and_handle_interrupt(
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 43, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 102, in launch
    return function(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 989, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 1035, in _run_stage
    self.fit_loop.run()
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/loops/fit_loop.py", line 202, in run
    self.advance()
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/loops/fit_loop.py", line 359, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 136, in run
    self.advance(data_fetcher)
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 240, in advance
    batch_output = self.automatic_optimization.run(trainer.optimizers[0], batch_idx, kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 187, in run
    self._optimizer_step(batch_idx, closure)
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 265, in _optimizer_step
    call._call_lightning_module_hook(
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 157, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/core/module.py", line 1282, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/core/optimizer.py", line 151, in step
    step_output = self._strategy.optimizer_step(self._optimizer, closure, **kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/strategies/ddp.py", line 264, in optimizer_step
    optimizer_output = super().optimizer_step(optimizer, closure, model, **kwargs)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/strategies/strategy.py", line 230, in optimizer_step
    return self.precision_plugin.optimizer_step(optimizer, model=model, closure=closure, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/plugins/precision/precision.py", line 117, in optimizer_step
    return optimizer.step(closure=closure, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/torch/optim/optimizer.py", line 385, in wrapper
    out = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/torch/optim/optimizer.py", line 76, in _use_grad
    ret = func(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/torch/optim/adam.py", line 146, in step
    loss = closure()
           ^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/plugins/precision/precision.py", line 104, in _wrap_closure
    closure_result = closure()
                     ^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 140, in __call__
    self._result = self.closure(*args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 126, in closure
    step_output = self._step_fn()
                  ^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 315, in _training_step
    training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 309, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/strategies/strategy.py", line 381, in training_step
    return self._forward_redirection(self.model, self.lightning_module, "training_step", *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/strategies/strategy.py", line 633, in __call__
    wrapper_output = wrapper_module(*args, **kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/torch/nn/parallel/distributed.py", line 1523, in forward
    else self._run_ddp_forward(*inputs, **kwargs)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/torch/nn/parallel/distributed.py", line 1359, in _run_ddp_forward
    return self.module(*inputs, **kwargs)  # type: ignore[index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/strategies/strategy.py", line 626, in wrapped_forward
    out = method(*_args, **_kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kadotab/python/CMRxRecon2024/code/cmrxrecon/dl/lowrank_varnet.py", line 67, in training_step
    self.logger.experiment.log({"train/time_components": wandb.plot.line_series(
                                                         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/wandb/plot/line_series.py", line 82, in line_series
    return wandb.plot_table(
           ^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/wandb/sdk/lib/preinit.py", line 36, in preinit_wrapper
    raise wandb.Error(f"You must call wandb.init() before {name}()")
wandb.errors.Error: You must call wandb.init() before wandb.plot_table()
Traceback (most recent call last):
  File "/home/kadotab/python/CMRxRecon2024/code/train.py", line 46, in <module>
    main(args)
  File "/home/kadotab/python/CMRxRecon2024/code/train.py", line 31, in main
    trainer.fit(model=model, datamodule=data_module)
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
    call._call_and_handle_interrupt(
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 43, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 102, in launch
    return function(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 989, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 1035, in _run_stage
    self.fit_loop.run()
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/loops/fit_loop.py", line 202, in run
    self.advance()
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/loops/fit_loop.py", line 359, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 136, in run
    self.advance(data_fetcher)
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 240, in advance
    batch_output = self.automatic_optimization.run(trainer.optimizers[0], batch_idx, kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 187, in run
    self._optimizer_step(batch_idx, closure)
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 265, in _optimizer_step
    call._call_lightning_module_hook(
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 157, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/core/module.py", line 1282, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/core/optimizer.py", line 151, in step
    step_output = self._strategy.optimizer_step(self._optimizer, closure, **kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/strategies/ddp.py", line 264, in optimizer_step
    optimizer_output = super().optimizer_step(optimizer, closure, model, **kwargs)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/strategies/strategy.py", line 230, in optimizer_step
    return self.precision_plugin.optimizer_step(optimizer, model=model, closure=closure, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/plugins/precision/precision.py", line 117, in optimizer_step
    return optimizer.step(closure=closure, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/torch/optim/optimizer.py", line 385, in wrapper
    out = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/torch/optim/optimizer.py", line 76, in _use_grad
    ret = func(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/torch/optim/adam.py", line 146, in step
    loss = closure()
           ^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/plugins/precision/precision.py", line 104, in _wrap_closure
    closure_result = closure()
                     ^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 140, in __call__
    self._result = self.closure(*args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 126, in closure
    step_output = self._step_fn()
                  ^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 315, in _training_step
    training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 309, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/strategies/strategy.py", line 381, in training_step
    return self._forward_redirection(self.model, self.lightning_module, "training_step", *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/pytorch_lightning/strategies/strategy.py", line 633, in __call__
    wrapper_output = wrapper_module(*args, **kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/torch/nn/parallel/distributed.py", line 1519, in forward
    inputs, kwargs = self._pre_forward(*inputs, **kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/kadotab.23170376.0/env/lib/python3.11/site-packages/torch/nn/parallel/distributed.py", line 1413, in _pre_forward
    if torch.is_grad_enabled() and self.reducer._rebuild_buckets():
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: It looks like your LightningModule has parameters that were not used in producing the loss returned by training_step. If this is intentional, you must enable the detection of unused parameters in DDP, either by setting the string value `strategy='ddp_find_unused_parameters_true'` or by setting the flag in the strategy with `strategy=DDPStrategy(find_unused_parameters=True)`.
wandb: You can sync this run to the cloud by running:
wandb: wandb sync cmrxrecon/dl/model_weights/wandb/offline-run-20240715_102759-3zvb7tcb
wandb: Find logs at: cmrxrecon/dl/model_weights/wandb/offline-run-20240715_102759-3zvb7tcb/logs
srun: error: gra867: task 1: Exited with exit code 1
srun: Terminating StepId=23170376.0
slurmstepd: error: *** STEP 23170376.0 ON gra867 CANCELLED AT 2024-07-15T10:29:37 ***
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:  50%|█████     | 1/2 [00:06<00:06,  0.16it/s]Sanity Checking DataLoader 0: 100%|██████████| 2/2 [00:06<00:00,  0.30it/s]                                                                           Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/3882 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/3882 [00:00<?, ?it/s] Epoch 0:   0%|          | 1/3882 [00:05<5:51:43,  0.18it/s]Epoch 0:   0%|          | 1/3882 [00:05<5:51:48,  0.18it/s, v_num=7tcb, train/loss_step=0.001]srun: error: gra867: task 0: Terminated
srun: Force Terminated StepId=23170376.0
